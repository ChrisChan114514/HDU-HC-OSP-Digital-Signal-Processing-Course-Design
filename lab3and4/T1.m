% 定义数字滤波器的设计参数
wp = 0.2*pi; % 通带截止频率（归一化，单位：弧度/采样点）
ws = 0.3*pi; % 阻带截止频率（归一化，单位：弧度/采样点）
rp = 1;      % 通带最大允许纹波（单位：dB）
rs = 15;     % 阻带最小衰减（单位：dB）
Fs = 1;      % 采样频率，归一化为 1（简化计算）
%此时，数字域频率（0,pai）对应模拟域频率为（0,0.5HZ）

0
% 将数字滤波器的频率转换为模拟滤波器的频率
wp1 = 2*Fs*tan(wp/2); % 使用公式 ωp' = 2*Fs*tan(ωp/2) 转换通带频率
ws1 = 2*Fs*tan(ws/2); % 使用公式 ωs' = 2*Fs*tan(ωs/2) 转换阻带频率

% 计算巴特沃斯模拟滤波器的阶数和归一化截止频率
[N, Wn] = buttord(wp1, ws1, rp, rs, 's'); % 's' 表示设计模拟滤波器

% 构建巴特沃斯模拟滤波器的零点、极点和增益
[Z, P, K] = buttap(N); % 生成阶数为 N 的巴特沃斯滤波器的零点 Z、极点 P 和增益 K

% 将零点、极点和增益转换为模拟滤波器的传递函数系数
[Bap, Aap] = zp2tf(Z, P, K); % Bap 为分子系数，Aap 为分母系数

% 将归一化滤波器转换为指定截止频率 Wn 的低通滤波器
[b, a] = lp2lp(Bap, Aap, Wn); % 调整传递函数到指定截止频率

% 使用双线性变换将模拟滤波器转换为数字滤波器
[bz, az] = bilinear(b, a, Fs); % bz 为数字滤波器分子系数，az 为分母系数

% 计算数字滤波器的频率响应
[H, W] = freqz(bz, az); % H 为复频率响应，W 为归一化频率（弧度/采样点）

% 显示数字滤波器的分子和分母系数
disp(bz); % 输出分子系数
disp(az); % 输出分母系数
disp(N); 
%这里的输出有6阶低通滤波器


% 绘制频率响应图
subplot(2,1,1); % 创建 2 行 1 列的子图，选择第一个子图
plot(W*Fs/pi, abs(H)); % 绘制线性幅度响应，横轴为实际频率（Hz）
grid on; % 显示网格线
xlabel('频率/Hz'); % 横轴标签
ylabel('幅度'); % 纵轴标签
title('(a)'); % 子图标题

subplot(2,1,2); % 选择第二个子图
plot(W/pi, 20*log10(abs(H))); % 绘制 dB 幅度响应，横轴为归一化频率
grid on; % 显示网格线
xlabel('\omega/\pi'); % 横轴标签（归一化频率）
ylabel('幅度 (dB)'); % 纵轴标签
title('(b)'); % 子图标题